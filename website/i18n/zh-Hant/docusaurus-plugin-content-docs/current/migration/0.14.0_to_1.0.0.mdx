---
title: ^0.14.0 åˆ° ^1.0.0
---

import { Link } from "@site/src/components/Link";


ç¶“éæ¼«é•·çš„ç­‰å¾…ï¼ŒRiverpod è¿ä¾†äº†é¦–å€‹ç©©å®šç‰ˆæœ¬çš„é‡‹å‡º ğŸ‘

è¦æª¢è¦–å®Œæ•´çš„è®Šæ›´åˆ—è¡¨ï¼Œè«‹åƒé–± [Changelog](https://pub.dev/packages/flutter_riverpod/changelog#100).  
åœ¨æœ¬é é¢ä¸­ï¼Œæˆ‘å€‘å°‡é‡é»ä»‹ç´¹å¦‚ä½•å°‡ç¾æœ‰çš„ Riverpod æ‡‰ç”¨ç¨‹å¼å¾ç‰ˆæœ¬ 0.14.x é·ç§»åˆ°ç‰ˆæœ¬ 1.0.0ã€‚

## ä½¿ç”¨é·ç§»å·¥å…·è‡ªå‹•å‡ç´šå°ˆæ¡ˆåˆ°æ–°çš„èªæ³•

åœ¨è§£é‡‹å„ç¨®è®Šæ›´ä¹‹å‰ï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯ï¼ŒRiverpod æä¾›äº†ä¸€å€‹å‘½ä»¤åˆ—å·¥å…·ï¼Œå¯ä»¥è‡ªå‹•ç‚ºæ‚¨çš„å°ˆæ¡ˆé€²è¡Œé·ç§»ã€‚

### å®‰è£å‘½ä»¤åˆ—å·¥å…·

è¦å®‰è£é·ç§»å·¥å…·ï¼Œè«‹åŸ·è¡Œï¼š

```sh
dart pub global activate riverpod_cli
```

ç¾åœ¨æ‚¨æ‡‰è©²èƒ½å¤ åŸ·è¡Œï¼š

```sh
riverpod --help
```

### ä½¿ç”¨èªªæ˜

æ—¢ç„¶å‘½ä»¤åˆ—å·¥å…·å·²ç¶“å®‰è£ï¼Œæˆ‘å€‘å¯ä»¥é–‹å§‹ä½¿ç”¨å®ƒäº†ã€‚

- é¦–å…ˆï¼Œåœ¨çµ‚ç«¯ä¸­é–‹å•Ÿæ‚¨æƒ³è¦é·ç§»çš„å°ˆæ¡ˆã€‚
- **ä¸ç”¨** å‡ç´š Riverpod.  
  é·ç§»å·¥å…·å°‡æœƒç‚ºæ‚¨å‡ç´š Riverpod çš„ç‰ˆæœ¬ã€‚

  :::danger
  ä¸å‡ç´š Riverpod éå¸¸é‡è¦ã€‚  
  å¦‚æœæ‚¨å·²ç¶“å®‰è£äº†ç‰ˆæœ¬ 1.0.0ï¼Œè©²å·¥å…·å°‡ç„¡æ³•æ­£å¸¸åŸ·è¡Œã€‚å› æ­¤ï¼Œè«‹ç¢ºä¿åœ¨å•Ÿå‹•å·¥å…·ä¹‹å‰æ­£ç¢ºä½¿ç”¨è¼ƒèˆŠçš„ç‰ˆæœ¬ã€‚
  :::

- ç¢ºä¿æ‚¨çš„å°ˆæ¡ˆä¸åŒ…å«éŒ¯èª¤ã€‚
- åŸ·è¡Œ
  ```sh
  riverpod migrate
  ```

ç„¶å¾Œï¼Œè©²å·¥å…·å°‡åˆ†ææ‚¨çš„å°ˆæ¡ˆä¸¦æå‡ºæ›´æ”¹å»ºè­°ã€‚ä¾‹å¦‚ï¼Œæ‚¨å¯èƒ½æœƒçœ‹åˆ°ï¼š

```diff
-Widget build(BuildContext context, ScopedReader watch) {
+Widget build(BuildContext context, Widget ref) {
-  MyModel state = watch(provider);
+  MyModel state = ref.watch(provider);
}

Accept change (y = yes, n = no [default], A = yes to all, q = quit)?
```

è¦æ¥å—æ›´æ”¹ï¼Œåªéœ€æŒ‰ <kbd>y</kbd> éµã€‚å¦å‰‡ï¼Œè¦æ‹’çµ•æ›´æ”¹ï¼ŒæŒ‰ <kbd>n</kbd> éµ.

## è®Šæ›´å…§å®¹

ç¾åœ¨æˆ‘å€‘å·²ç¶“ç­è§£ç­å¦‚ä½•ä½¿ç”¨å‘½ä»¤åˆ—å·¥å…·è‡ªå‹•å‡ç´šå°ˆæ¡ˆï¼Œè®“æˆ‘å€‘è©³ç´°çœ‹çœ‹æ‰€éœ€çš„æ›´æ”¹ã€‚


### èªæ³•çµ±ä¸€

Riverpod 1.0.0 ç‰ˆæœ¬ä¸»è¦é—œæ³¨èˆ‡æä¾›ç¨‹å¼äº’å‹•çš„èªæ³•çµ±ä¸€ã€‚  
åœ¨æ­¤ä¹‹å‰ï¼ŒRiverpod å°æ–¼è®€å–æä¾›ç¨‹å¼æœ‰è¨±å¤šé¡ä¼¼ä½†ä¸åŒçš„èªæ³•ï¼Œ
ä¾‹å¦‚ `ref.watch(provider)` èˆ‡ `useProvider(provider)` èˆ‡ `watch(provider)`ã€‚  
åœ¨ç‰ˆæœ¬ 1.0.0 ä¸­ï¼Œåªå‰©ä¸‹ä¸€ç¨®èªæ³•ï¼š `ref.watch(provider)`ã€‚å…¶ä»–çš„èªæ³•å·²ç¶“è¢«ç§»é™¤ã€‚

ä¾‹å¦‚ï¼š

- `useProvider` å·²è¢«ç§»é™¤ï¼Œè€Œæ¨è–¦ä½¿ç”¨ `HookConsumerWidget`ã€‚

  ä¹‹å‰:

  ```dart
  class Example extends HookWidget {
    @override
    Widget build(BuildContext context) {
      useState(...);
      int count = useProvider(counterProvider);
      ...
    }
  }
  ```

  ä¹‹å¾Œ:

  ```dart
  class Example extends HookConsumerWidget {
    @override
    Widget build(BuildContext context, WidgetRef ref) {
      useState(...);
      int count = ref.watch(counterProvider);
      ...
    }
  }
  ```

- åœ¨ `ConsumerWidget` çš„ `build` æ–¹æ³•å’Œ `Consumer` çš„ `builder` æ–¹æ³•åŸå‹ç™¼ç”Ÿäº†è®ŠåŒ–.
 
  ä¹‹å‰:

  ```dart
  class Example extends ConsumerWidget {
    @override
    Widget build(BuildContext context, ScopedReader watch) {
      int count = watch(counterProvider);
      ...
    }
  }

  Consumer(
    builder: (context, watch, child) {
      int count = watch(counterProvider);
      ...
    }
  )
  ```

  ä¹‹å¾Œ:

  ```dart
  class Example extends ConsumerWidget {
    @override
    Widget build(BuildContext context, WidgetRef ref) {
      int count = ref.watch(counterProvider);
      ...
    }
  }

  Consumer(
    builder: (context, ref, child) {
      int count = ref.watch(counterProvider);
      ...
    }
  )
  ```

- `context.read` è¢«ç§»é™¤ï¼Œå–è€Œä»£ä¹‹çš„æ˜¯ `ref.read` ã€‚

  ä¹‹å‰:

  ```dart
  class Example extends StatelessWidget {
    @override
    Widget build(BuildContext context) {
      SomeButton(
        onPressed: () => context.read(provider.notifier).doSomething(),
      );
    }
  }
  ```

  ä¹‹å¾Œ:

  ```dart
  class Example extends ConsumerWidget {
    @override
    Widget build(BuildContext context, WidgetRef ref) {
      SomeButton(
        onPressed: () => ref.read(provider.notifier).doSomething(),
      );
    }
  }
  ```

### StateProvider æ›´æ–°

[StateProvider] å·²æ›´æ–°ä»¥åŒ¹é… [StateNotifierProvider]ã€‚

åœ¨æ›´æ–°ä¹‹å‰ï¼Œä½¿ç”¨ `ref.watch(StateProvider)` æœƒè¿”å›ä¸€å€‹ `StateController` ä¾‹é …ã€‚
ç¾åœ¨å®ƒåªè¿”å› `StateController` çš„ç‹€æ…‹ã€‚

è¦é€²è¡Œé·ç§»ï¼Œæœ‰å¹¾ç¨®è§£æ±ºæ–¹æ¡ˆã€‚  
å¦‚æœæ‚¨çš„ç¨‹å¼ç¢¼åƒ…ç²å–ç‹€æ…‹è€Œä¸ä¿®æ”¹å®ƒï¼Œå¯ä»¥å¾ï¼š

```dart
final provider = StateProvider<int>(...);

Consumer(
  builder: (context, ref, child) {
    StateController<int> count = ref.watch(provider);

    return Text('${count.state}');
  }
)
```

è®Šåˆ°:

```dart
final provider = StateProvider<int>(...);

Consumer(
  builder: (context, ref, child) {
    int count = ref.watch(provider);

    return Text('${count}');
  }
)
```

æˆ–è€…ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨æ–°çš„ `StateProvider.state` ä¾†ä¿æŒèˆŠçš„è¡Œç‚ºã€‚

```dart
final provider = StateProvider<int>(...);

Consumer(
  builder: (context, ref, child) {
    StateController<int> count = ref.watch(provider.state);

    return Text('${count.state}');
  }
)
```

[statenotifierprovider]: ../providers/state_notifier_provider
[stateprovider]: ../providers/state_provider
[statenotifier]: https://pub.dev/documentation/state_notifier/latest/state_notifier/StateNotifier-class.html
