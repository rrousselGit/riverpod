---
title: ^0.14.0 è‡³ ^1.0.0
---

ç»è¿‡æ¼«é•¿çš„ç­‰å¾…ï¼ŒRiverpod çš„ç¬¬ä¸€ä¸ªç¨³å®šç‰ˆæœ¬ç»ˆäºå‘å¸ƒäº†ğŸ‘

è¦æŸ¥çœ‹å®Œæ•´çš„æ›´æ”¹åˆ—è¡¨ï¼Œè¯·æŸ¥é˜… [Changelog](https://pub.dev/packages/flutter_riverpod/changelog#100)ã€‚

æœ¬é¡µé¢æˆ‘ä»¬å°†é‡ç‚¹ä»‹ç»å¦‚ä½•å°†ç°æœ‰çš„ Riverpod åº”ç”¨ç¨‹åºä» 0.14.x ç‰ˆè¿ç§»åˆ° 1.0.0 ç‰ˆã€‚

## ä½¿ç”¨è¿ç§»å·¥å…·è‡ªåŠ¨å°†ä½ çš„é¡¹ç›®å‡çº§åˆ°æ–°è¯­æ³•

åœ¨è§£é‡Šå„ç§å˜åŒ–ä¹‹å‰ï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯ Riverpod é™„å¸¦äº†ä¸€ä¸ªå‘½ä»¤è¡Œå·¥å…·ï¼Œå¯ä»¥è‡ªåŠ¨ä¸ºä½ è¿ç§»é¡¹ç›®ã€‚

### å®‰è£…å‘½ä»¤è¡Œ

è¦å®‰è£…è¿ç§»å·¥å…·ï¼Œè¯·è¿è¡Œï¼š

```sh
dart pub global activate riverpod_cli
```

ä½ ç°åœ¨åº”è¯¥èƒ½å¤Ÿè¿è¡Œï¼š

```sh
riverpod --help
```

### ä½¿ç”¨æ–¹æ³•

ç°åœ¨å‘½ä»¤è¡Œå·²ç»å®‰è£…å¥½äº†ï¼Œæˆ‘ä»¬å¯ä»¥å¼€å§‹ä½¿ç”¨å®ƒäº†ã€‚

- é¦–å…ˆï¼Œåœ¨ä½ çš„ç»ˆç«¯ä¸­æ‰“å¼€ä½ è¦è¿ç§»çš„é¡¹ç›®ã€‚
- **å…ˆåˆ«æ€¥ç€å‡çº§** Riverpodï¼Œè¿ç§»å·¥å…·ä¼šä¸ºä½ å‡çº§ Riverpod çš„ç‰ˆæœ¬ã€‚

  :::danger
  ä¸æ€¥ç€å‡çº§ Riverpod è¿™ç‚¹å¾ˆé‡è¦ã€‚å¦‚æœä½ å·²ç»å®‰è£…äº† 1.0.0 ç‰ˆï¼Œè¯¥å·¥å…·å°†æ— æ³•æ­£å¸¸æ‰§è¡Œã€‚

  å› æ­¤ï¼Œè¯·ç¡®ä¿åœ¨å¯åŠ¨è¯¥å·¥å…·ä¹‹å‰æ­£ç¡®ä½¿ç”¨æ—§ç‰ˆæœ¬ã€‚
  :::

- ç¡®ä¿ä½ çš„é¡¹ç›®ä¸åŒ…å«é”™è¯¯ã€‚
- æ‰§è¡Œï¼š
  ```sh
  riverpod migrate
  ```

ç„¶åè¯¥å·¥å…·å°†åˆ†æä½ çš„é¡¹ç›®å¹¶æå‡ºæ›´æ”¹å»ºè®®ï¼Œä½ å¯èƒ½çœ‹åˆ°ï¼š

```diff
-Widget build(BuildContext context, ScopedReader watch) {
+Widget build(BuildContext context, Widget ref) {
-  MyModel state = watch(provider);
+  MyModel state = ref.watch(provider);
}

Accept change (y = yes, n = no [default], A = yes to all, q = quit)?
```

è¦æ¥å—æ›´æ”¹ï¼Œåªéœ€æŒ‰ <kbd>y</kbd>ï¼Œå¦åˆ™æ‹’ç»è¯·æŒ‰ <kbd>n</kbd>ã€‚

## æ”¹åŠ¨

ç°åœ¨æˆ‘ä»¬å·²ç»äº†è§£äº†å¦‚ä½•ä½¿ç”¨ CLI è‡ªåŠ¨å‡çº§ä½ çš„é¡¹ç›®ï¼Œè®©æˆ‘ä»¬è¯¦ç»†äº†è§£å¿…è¦çš„æ”¹åŠ¨ã€‚

### è¯­æ³•ç»Ÿä¸€

Riverpod 1.0.0 ç‰ˆä¾§é‡äºç»Ÿä¸€ä¸æä¾›è€…äº¤äº’çš„è¯­æ³•ã€‚

ä¹‹å‰ï¼ŒRiverpod æœ‰è®¸å¤šç›¸ä¼¼ä½†ä¸åŒçš„è¯­æ³•æ¥è¯»å–æä¾›è€…ï¼Œä¾‹å¦‚ `ref.watch(provider)`ã€`useProvider(provider)`ã€`watch(provider)`ã€‚

å¯¹äº 1.0.0 ç‰ˆï¼Œåªä¿ç•™ä¸€ç§è¯­æ³•ï¼š`ref.watch(provider)`ï¼Œå…¶ä»–æ–¹æ³•å·²è¢«ç§»é™¤ã€‚

åƒæ˜¯è¿™æ ·ï¼š

- `useProvider` è¢« `HookConsumerWidget` å–ä»£ã€‚

  åŸå…ˆï¼š

  ```dart
  class Example extends HookWidget {
    @override
    Widget build(BuildContext context) {
      useState(...);
      int count = useProvider(counterProvider);
      ...
    }
  }
  ```

  ç°åœ¨ï¼š

  ```dart
  class Example extends HookConsumerWidget {
    @override
    Widget build(BuildContext context, WidgetRef ref) {
      useState(...);
      int count = ref.watch(counterProvider);
      ...
    }
  }
  ```

- æ”¹å˜äº† `ConsumerWidget` çš„ `build` å’Œ `Consumer` çš„ `builder` çš„å‚æ•°ç±»å‹ã€‚

  åŸå…ˆï¼š

  ```dart
  class Example extends ConsumerWidget {
    @override
    Widget build(BuildContext context, ScopedReader watch) {
      int count = watch(counterProvider);
      ...
    }
  }

  Consumer(
    builder: (context, watch, child) {
      int count = watch(counterProvider);
      ...
    }
  )
  ```

  ç°åœ¨ï¼š

  ```dart
  class Example extends ConsumerWidget {
    @override
    Widget build(BuildContext context, WidgetRef ref) {
      int count = ref.watch(counterProvider);
      ...
    }
  }

  Consumer(
    builder: (context, ref, child) {
      int count = ref.watch(counterProvider);
      ...
    }
  )
  ```

- `context.read` è¢« `ref.read` å–ä»£ã€‚

  åŸå…ˆï¼š

  ```dart
  class Example extends StatelessWidget {
    @override
    Widget build(BuildContext context) {
      SomeButton(
        onPressed: () => context.read(provider.notifier).doSomething(),
      );
    }
  }
  ```

  ç°åœ¨ï¼š

  ```dart
  class Example extends ConsumerWidget {
    @override
    Widget build(BuildContext context, WidgetRef ref) {
      SomeButton(
        onPressed: () => ref.read(provider.notifier).doSomething(),
      );
    }
  }
  ```

### æ›´æ–° StateProvider

[StateProvider] å·²æ›´æ–°ä»¥åŒ¹é… [StateNotifierProvider]ã€‚

åŸå…ˆæ‰§è¡Œ ref.watch(StateProvider) ä¼šè¿”å›ä¸€ä¸ª StateController å®ä¾‹ï¼Œç°åœ¨å®ƒåªè¿”å› StateController çš„çŠ¶æ€ã€‚

ä½ æœ‰ä¸€äº›è§£å†³æ–¹æ¡ˆæ¥è¿ç§»ä»£ç ã€‚

å¦‚æœä½ çš„ä»£ç åªæ˜¯è·å–çŠ¶æ€è€Œä¸ä¿®æ”¹å®ƒï¼Œä½ å¯ä»¥åƒä¸‹é¢è¿™æ ·ä»ï¼š

```dart
final provider = StateProvider<int>(...);

Consumer(
  builder: (context, ref, child) {
    StateController<int> count = ref.watch(provider);

    return Text('${count.state}');
  }
)
```

ä¿®æ”¹ä¸ºï¼š

```dart
final provider = StateProvider<int>(...);

Consumer(
  builder: (context, ref, child) {
    int count = ref.watch(provider);

    return Text('${count}');
  }
)
```

æˆ–è€…ä½ å¯ä»¥ä½¿ç”¨æ–°çš„ `StateProvider.state` æ¥ä¿æŒæ—§çš„è¡Œä¸ºã€‚

```dart
final provider = StateProvider<int>(...);

Consumer(
  builder: (context, ref, child) {
    StateController<int> count = ref.watch(provider.state);

    return Text('${count.state}');
  }
)
```

[statenotifierprovider]: ../providers/state_notifier_provider
[stateprovider]: ../providers/state_provider
[statenotifier]: https://pub.dev/documentation/state_notifier/latest/state_notifier/StateNotifier-class.html
