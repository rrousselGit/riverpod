---
title: ^0.14.0 åˆ° ^1.0.0
---

import { Link } from "@site/src/components/Link";


ç»è¿‡æ¼«é•¿çš„ç­‰å¾…ï¼ŒRiverpod è¿æ¥äº†é¦–ä¸ªç¨³å®šç‰ˆæœ¬çš„å‘å¸ƒ ğŸ‘

è¦æŸ¥çœ‹å®Œæ•´çš„å˜æ›´åˆ—è¡¨ï¼Œè¯·å‚é˜… [Changelog](https://pub.dev/packages/flutter_riverpod/changelog#100).  
åœ¨æœ¬é¡µé¢ä¸­ï¼Œæˆ‘ä»¬å°†é‡ç‚¹ä»‹ç»å¦‚ä½•å°†ç°æœ‰çš„ Riverpod åº”ç”¨ç¨‹åºä»ç‰ˆæœ¬ 0.14.x è¿ç§»åˆ°ç‰ˆæœ¬ 1.0.0ã€‚

## ä½¿ç”¨è¿ç§»å·¥å…·è‡ªåŠ¨å‡çº§é¡¹ç›®åˆ°æ–°çš„è¯­æ³•

åœ¨è§£é‡Šå„ç§å˜æ›´ä¹‹å‰ï¼Œå€¼å¾—æ³¨æ„çš„æ˜¯ï¼ŒRiverpod æä¾›äº†ä¸€ä¸ªå‘½ä»¤è¡Œå·¥å…·ï¼Œå¯ä»¥è‡ªåŠ¨ä¸ºæ‚¨çš„é¡¹ç›®è¿›è¡Œè¿ç§»ã€‚

### å®‰è£…å‘½ä»¤è¡Œå·¥å…·

è¦å®‰è£…è¿ç§»å·¥å…·ï¼Œè¯·è¿è¡Œï¼š

```sh
dart pub global activate riverpod_cli
```

ç°åœ¨æ‚¨åº”è¯¥èƒ½å¤Ÿè¿è¡Œï¼š

```sh
riverpod --help
```

### ä½¿ç”¨è¯´æ˜

æ—¢ç„¶å‘½ä»¤è¡Œå·¥å…·å·²ç»å®‰è£…ï¼Œæˆ‘ä»¬å¯ä»¥å¼€å§‹ä½¿ç”¨å®ƒäº†ã€‚

- é¦–å…ˆï¼Œåœ¨ç»ˆç«¯ä¸­æ‰“å¼€æ‚¨æƒ³è¦è¿ç§»çš„é¡¹ç›®ã€‚
- **ä¸ç”¨** å‡çº§ Riverpod.  
  è¿ç§»å·¥å…·å°†ä¼šä¸ºæ‚¨å‡çº§ Riverpod çš„ç‰ˆæœ¬ã€‚

  :::danger
  ä¸å‡çº§ Riverpod éå¸¸é‡è¦ã€‚  
  å¦‚æœæ‚¨å·²ç»å®‰è£…äº†ç‰ˆæœ¬ 1.0.0ï¼Œè¯¥å·¥å…·å°†æ— æ³•æ­£å¸¸æ‰§è¡Œã€‚å› æ­¤ï¼Œè¯·ç¡®ä¿åœ¨å¯åŠ¨å·¥å…·ä¹‹å‰æ­£ç¡®ä½¿ç”¨è¾ƒæ—§çš„ç‰ˆæœ¬ã€‚
  :::

- ç¡®ä¿æ‚¨çš„é¡¹ç›®ä¸åŒ…å«é”™è¯¯ã€‚
- æ‰§è¡Œ
  ```sh
  riverpod migrate
  ```

ç„¶åï¼Œè¯¥å·¥å…·å°†åˆ†ææ‚¨çš„é¡¹ç›®å¹¶æå‡ºæ›´æ”¹å»ºè®®ã€‚ä¾‹å¦‚ï¼Œæ‚¨å¯èƒ½ä¼šçœ‹åˆ°ï¼š

```diff
-Widget build(BuildContext context, ScopedReader watch) {
+Widget build(BuildContext context, Widget ref) {
-  MyModel state = watch(provider);
+  MyModel state = ref.watch(provider);
}

Accept change (y = yes, n = no [default], A = yes to all, q = quit)?
```

è¦æ¥å—æ›´æ”¹ï¼Œåªéœ€æŒ‰ <kbd>y</kbd> é”®ã€‚å¦åˆ™ï¼Œè¦æ‹’ç»æ›´æ”¹ï¼ŒæŒ‰ <kbd>n</kbd> é”®.

## å˜æ›´å†…å®¹

ç°åœ¨æˆ‘ä»¬å·²ç»äº†è§£äº†å¦‚ä½•ä½¿ç”¨å‘½ä»¤è¡Œå·¥å…·è‡ªåŠ¨å‡çº§é¡¹ç›®ï¼Œè®©æˆ‘ä»¬è¯¦ç»†çœ‹çœ‹æ‰€éœ€çš„æ›´æ”¹ã€‚


### è¯­æ³•ç»Ÿä¸€

Riverpod 1.0.0 ç‰ˆæœ¬ä¸»è¦å…³æ³¨ä¸æä¾›ç¨‹åºäº¤äº’çš„è¯­æ³•ç»Ÿä¸€ã€‚  
åœ¨æ­¤ä¹‹å‰ï¼ŒRiverpod å¯¹äºè¯»å–æä¾›ç¨‹åºæœ‰è®¸å¤šç±»ä¼¼ä½†ä¸åŒçš„è¯­æ³•ï¼Œ
ä¾‹å¦‚ `ref.watch(provider)` ä¸ `useProvider(provider)` ä¸ `watch(provider)`ã€‚  
åœ¨ç‰ˆæœ¬ 1.0.0 ä¸­ï¼Œåªå‰©ä¸‹ä¸€ç§è¯­æ³•ï¼š `ref.watch(provider)`ã€‚å…¶ä»–çš„è¯­æ³•å·²ç»è¢«ç§»é™¤ã€‚

ä¾‹å¦‚ï¼š

- `useProvider` å·²è¢«ç§»é™¤ï¼Œè€Œæ¨èä½¿ç”¨ `HookConsumerWidget`ã€‚

  ä¹‹å‰:

  ```dart
  class Example extends HookWidget {
    @override
    Widget build(BuildContext context) {
      useState(...);
      int count = useProvider(counterProvider);
      ...
    }
  }
  ```

  ä¹‹å:

  ```dart
  class Example extends HookConsumerWidget {
    @override
    Widget build(BuildContext context, WidgetRef ref) {
      useState(...);
      int count = ref.watch(counterProvider);
      ...
    }
  }
  ```

- åœ¨ `ConsumerWidget` çš„ `build` æ–¹æ³•å’Œ `Consumer` çš„ `builder` æ–¹æ³•åŸå‹å‘ç”Ÿäº†å˜åŒ–.
 
  ä¹‹å‰:

  ```dart
  class Example extends ConsumerWidget {
    @override
    Widget build(BuildContext context, ScopedReader watch) {
      int count = watch(counterProvider);
      ...
    }
  }

  Consumer(
    builder: (context, watch, child) {
      int count = watch(counterProvider);
      ...
    }
  )
  ```

  ä¹‹å:

  ```dart
  class Example extends ConsumerWidget {
    @override
    Widget build(BuildContext context, WidgetRef ref) {
      int count = ref.watch(counterProvider);
      ...
    }
  }

  Consumer(
    builder: (context, ref, child) {
      int count = ref.watch(counterProvider);
      ...
    }
  )
  ```

- `context.read` è¢«ç§»é™¤ï¼Œå–è€Œä»£ä¹‹çš„æ˜¯ `ref.read` ã€‚

  ä¹‹å‰:

  ```dart
  class Example extends StatelessWidget {
    @override
    Widget build(BuildContext context) {
      SomeButton(
        onPressed: () => context.read(provider.notifier).doSomething(),
      );
    }
  }
  ```

  ä¹‹å:

  ```dart
  class Example extends ConsumerWidget {
    @override
    Widget build(BuildContext context, WidgetRef ref) {
      SomeButton(
        onPressed: () => ref.read(provider.notifier).doSomething(),
      );
    }
  }
  ```

### StateProvider æ›´æ–°

[StateProvider] å·²æ›´æ–°ä»¥åŒ¹é… [StateNotifierProvider]ã€‚

åœ¨æ›´æ–°ä¹‹å‰ï¼Œä½¿ç”¨ `ref.watch(StateProvider)` ä¼šè¿”å›ä¸€ä¸ª `StateController` å®ä¾‹ã€‚
ç°åœ¨å®ƒåªè¿”å› `StateController` çš„çŠ¶æ€ã€‚

è¦è¿›è¡Œè¿ç§»ï¼Œæœ‰å‡ ç§è§£å†³æ–¹æ¡ˆã€‚  
å¦‚æœæ‚¨çš„ä»£ç ä»…è·å–çŠ¶æ€è€Œä¸ä¿®æ”¹å®ƒï¼Œå¯ä»¥ä»ï¼š

```dart
final provider = StateProvider<int>(...);

Consumer(
  builder: (context, ref, child) {
    StateController<int> count = ref.watch(provider);

    return Text('${count.state}');
  }
)
```

å˜åˆ°:

```dart
final provider = StateProvider<int>(...);

Consumer(
  builder: (context, ref, child) {
    int count = ref.watch(provider);

    return Text('${count}');
  }
)
```

æˆ–è€…ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨æ–°çš„ `StateProvider.state` æ¥ä¿æŒæ—§çš„è¡Œä¸ºã€‚

```dart
final provider = StateProvider<int>(...);

Consumer(
  builder: (context, ref, child) {
    StateController<int> count = ref.watch(provider.state);

    return Text('${count.state}');
  }
)
```

[statenotifierprovider]: ../providers/state_notifier_provider
[stateprovider]: ../providers/state_provider
[statenotifier]: https://pub.dev/documentation/state_notifier/latest/state_notifier/StateNotifier-class.html
